"use strict";(self.webpackChunkfhenix_docs=self.webpackChunkfhenix_docs||[]).push([[1996],{815:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>u,contentTitle:()=>l,default:()=>p,frontMatter:()=>s,metadata:()=>c,toc:()=>d});var r=n(4848),o=n(8453),a=n(1470),i=n(9365);const s={sidebar_position:100},l="Deploying (WIP)",c={id:"tutorial/Basic/Deploying",title:"Deploying (WIP)",description:"Now that we have our completed WrappingERC20 token, the next step is to see if our code actually works!",source:"@site/docs/tutorial/Basic/Deploying.mdx",sourceDirName:"tutorial/Basic",slug:"/tutorial/Basic/Deploying",permalink:"/docs/tutorial/Basic/Deploying",draft:!1,unlisted:!1,editUrl:"https://github.com/fhenixprotocol/fhenix-docs/tree/main/docs/tutorial/Basic/Deploying.mdx",tags:[],version:"current",sidebarPosition:100,frontMatter:{sidebar_position:100},sidebar:"tutorialSidebar",previous:{title:"Adding View Functions",permalink:"/docs/tutorial/Basic/Adding View Functions"},next:{title:"earlyWin",permalink:"/docs/tutorial/earlyWin"}},u={},d=[{value:"Compiling the Contract",id:"compiling-the-contract",level:3},{value:"Set up your Mnemonic",id:"set-up-your-mnemonic",level:4},{value:"Compiling your contracts",id:"compiling-your-contracts",level:4},{value:"Deploying the Contract",id:"deploying-the-contract",level:3},{value:"Tasks",id:"tasks",level:4}];function h(e){const t={a:"a",admonition:"admonition",code:"code",h1:"h1",h3:"h3",h4:"h4",p:"p",pre:"pre",strong:"strong",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.h1,{id:"deploying-wip",children:"Deploying (WIP)"}),"\n",(0,r.jsx)(t.p,{children:"Now that we have our completed WrappingERC20 token, the next step is to see if our code actually works!"}),"\n",(0,r.jsxs)(t.p,{children:["To do this, we'll be writing tests in typescript using hardhat, and deploying them on our ",(0,r.jsx)(t.a,{href:"/docs/devdocs/Setting%20Up%20Your%20Environment/Hardhat",children:"LocalFhenix "})," environment which we set up earlier"]}),"\n",(0,r.jsx)(t.admonition,{title:"Note",type:"tip",children:(0,r.jsx)(t.p,{children:"At this stage, using hardhat network is not supported, as Fhenix uses extensions to the EVM that enable FHE operations"})}),"\n",(0,r.jsx)(t.h3,{id:"compiling-the-contract",children:"Compiling the Contract"}),"\n",(0,r.jsx)(t.h4,{id:"set-up-your-mnemonic",children:"Set up your Mnemonic"}),"\n",(0,r.jsxs)(t.p,{children:["Hardhat uses an ",(0,r.jsx)(t.code,{children:".env"})," with mnemonics to deploy and interact with contracts. Copy the ",(0,r.jsx)(t.code,{children:".env.example"})," file to ",(0,r.jsx)(t.code,{children:".env"})," and set your mnemonics (you can use the default mnemonics if you just want to use LocalFhenix)"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-bash",children:"cp .env.example .env\n"})}),"\n",(0,r.jsx)(t.h4,{id:"compiling-your-contracts",children:"Compiling your contracts"}),"\n",(0,r.jsx)(t.p,{children:"First, let's see that our current contract is even valid. Let's run the following:"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{children:"pnpm compile\n"})}),"\n",(0,r.jsx)(t.p,{children:"This will compile our Solidity contract into bytecode, and generate helper components that we'll be able to use for testing and deployment. If everything worked, you should see something like:"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{children:"> cross-env TS_NODE_TRANSPILE_ONLY=true hardhat compile\n\nGenerating typings for: 5 artifacts in dir: types for target: ethers-v6\nSuccessfully generated 28 typings!\nCompiled 5 Solidity files successfully\n"})}),"\n",(0,r.jsx)(t.h3,{id:"deploying-the-contract",children:"Deploying the Contract"}),"\n",(0,r.jsx)(t.h4,{id:"tasks",children:"Tasks"}),"\n",(0,r.jsxs)(t.p,{children:["To help us deploy and perform actions you can make use of tasks. We'll add deployment and usage tasks for our new contract. We'll replace the deployment of the default contract with our WrappedERC20. Notice that the differences are mostly just the naming and constructor arguments that are different. Replace the ",(0,r.jsx)(t.code,{children:"deploy/deploy.ts"})," with the following content:"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-typescript",children:'import { DeployFunction } from "hardhat-deploy/types";\nimport { HardhatRuntimeEnvironment } from "hardhat/types";\n\nconst func: DeployFunction = async function (hre: HardhatRuntimeEnvironment) {\n  const { deployer } = await hre.getNamedAccounts();\n  const { deploy } = hre.deployments;\n\n  const werc20 = await deploy("WrappingERC20", {\n    from: deployer,\n    args: ["TestShieldedToken", "TST"],\n    log: true,\n    skipIfAlreadyDeployed: false,\n  });\n\n  console.log(`WrappingERC20 contract: `, werc20.address);\n};\n\nexport default func;\nfunc.id = "deploy_werc20";\nfunc.tags = ["WrappingERC20"];\n'})}),"\n",(0,r.jsx)(t.p,{children:"Now we can use this task to deploy our contract to either LocalFhenix, or the Devnet chain."}),"\n",(0,r.jsxs)(a.A,{children:[(0,r.jsx)(i.A,{value:"localfhenix",label:"LocalFhenix",default:!0,children:(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-bash",children:'# get tokens from localfhenix faucet\npnpm faucet\n# if this doesn\'t work, try running it directly\n# with "node getFromFaucet"\n# deploy the contract\npnpm deploy:contracts\n'})})}),(0,r.jsxs)(i.A,{value:"fhenix-frontier",label:"Fhenix Frontier",children:[(0,r.jsx)(t.p,{children:"Make sure your deployer address has some tokens, which you can get from []"}),(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{children:"pnpm deploy:contracts --network devnet\n"})})]})]}),"\n",(0,r.jsxs)(t.p,{children:["Okay, now we know how to create programmatic actions. You can find a few other examples of tasks that interact with the deployed contract in the ",(0,r.jsxs)(t.a,{href:"https://github.com/FhenixProtocol/werc20-example/tree/main/tasks",children:[(0,r.jsx)(t.code,{children:"tasks"})," "]}),"folder."]}),"\n",(0,r.jsx)(t.admonition,{title:"Making Changes?",type:"tip",children:(0,r.jsxs)(t.p,{children:["When deploying a contract hardhat creates a static deployment. If you want to make changes and redeploy using this method run ",(0,r.jsx)(t.strong,{children:(0,r.jsx)(t.code,{children:"pnpm clean"})})]})}),"\n",(0,r.jsx)(t.p,{children:"Let's move on to writing a few unit tests!"})]})}function p(e={}){const{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}},9365:(e,t,n)=>{n.d(t,{A:()=>i});n(6540);var r=n(4164);const o={tabItem:"tabItem_Ymn6"};var a=n(4848);function i(e){let{children:t,hidden:n,className:i}=e;return(0,a.jsx)("div",{role:"tabpanel",className:(0,r.A)(o.tabItem,i),hidden:n,children:t})}},1470:(e,t,n)=>{n.d(t,{A:()=>j});var r=n(6540),o=n(4164),a=n(3104),i=n(6347),s=n(205),l=n(7485),c=n(1682),u=n(9466);function d(e){return r.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,r.isValidElement)(e)&&function(e){const{props:t}=e;return!!t&&"object"==typeof t&&"value"in t}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function h(e){const{values:t,children:n}=e;return(0,r.useMemo)((()=>{const e=t??function(e){return d(e).map((e=>{let{props:{value:t,label:n,attributes:r,default:o}}=e;return{value:t,label:n,attributes:r,default:o}}))}(n);return function(e){const t=(0,c.X)(e,((e,t)=>e.value===t.value));if(t.length>0)throw new Error(`Docusaurus error: Duplicate values "${t.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[t,n])}function p(e){let{value:t,tabValues:n}=e;return n.some((e=>e.value===t))}function m(e){let{queryString:t=!1,groupId:n}=e;const o=(0,i.W6)(),a=function(e){let{queryString:t=!1,groupId:n}=e;if("string"==typeof t)return t;if(!1===t)return null;if(!0===t&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:t,groupId:n});return[(0,l.aZ)(a),(0,r.useCallback)((e=>{if(!a)return;const t=new URLSearchParams(o.location.search);t.set(a,e),o.replace({...o.location,search:t.toString()})}),[a,o])]}function f(e){const{defaultValue:t,queryString:n=!1,groupId:o}=e,a=h(e),[i,l]=(0,r.useState)((()=>function(e){let{defaultValue:t,tabValues:n}=e;if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!p({value:t,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${t}" but none of its children has the corresponding value. Available values are: ${n.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return t}const r=n.find((e=>e.default))??n[0];if(!r)throw new Error("Unexpected error: 0 tabValues");return r.value}({defaultValue:t,tabValues:a}))),[c,d]=m({queryString:n,groupId:o}),[f,y]=function(e){let{groupId:t}=e;const n=function(e){return e?`docusaurus.tab.${e}`:null}(t),[o,a]=(0,u.Dv)(n);return[o,(0,r.useCallback)((e=>{n&&a.set(e)}),[n,a])]}({groupId:o}),g=(()=>{const e=c??f;return p({value:e,tabValues:a})?e:null})();(0,s.A)((()=>{g&&l(g)}),[g]);return{selectedValue:i,selectValue:(0,r.useCallback)((e=>{if(!p({value:e,tabValues:a}))throw new Error(`Can't select invalid tab value=${e}`);l(e),d(e),y(e)}),[d,y,a]),tabValues:a}}var y=n(2303);const g={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var x=n(4848);function v(e){let{className:t,block:n,selectedValue:r,selectValue:i,tabValues:s}=e;const l=[],{blockElementScrollPositionUntilNextRender:c}=(0,a.a_)(),u=e=>{const t=e.currentTarget,n=l.indexOf(t),o=s[n].value;o!==r&&(c(t),i(o))},d=e=>{let t=null;switch(e.key){case"Enter":u(e);break;case"ArrowRight":{const n=l.indexOf(e.currentTarget)+1;t=l[n]??l[0];break}case"ArrowLeft":{const n=l.indexOf(e.currentTarget)-1;t=l[n]??l[l.length-1];break}}t?.focus()};return(0,x.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,o.A)("tabs",{"tabs--block":n},t),children:s.map((e=>{let{value:t,label:n,attributes:a}=e;return(0,x.jsx)("li",{role:"tab",tabIndex:r===t?0:-1,"aria-selected":r===t,ref:e=>l.push(e),onKeyDown:d,onClick:u,...a,className:(0,o.A)("tabs__item",g.tabItem,a?.className,{"tabs__item--active":r===t}),children:n??t},t)}))})}function b(e){let{lazy:t,children:n,selectedValue:o}=e;const a=(Array.isArray(n)?n:[n]).filter(Boolean);if(t){const e=a.find((e=>e.props.value===o));return e?(0,r.cloneElement)(e,{className:"margin-top--md"}):null}return(0,x.jsx)("div",{className:"margin-top--md",children:a.map(((e,t)=>(0,r.cloneElement)(e,{key:t,hidden:e.props.value!==o})))})}function w(e){const t=f(e);return(0,x.jsxs)("div",{className:(0,o.A)("tabs-container",g.tabList),children:[(0,x.jsx)(v,{...e,...t}),(0,x.jsx)(b,{...e,...t})]})}function j(e){const t=(0,y.A)();return(0,x.jsx)(w,{...e,children:d(e.children)},String(t))}},8453:(e,t,n)=>{n.d(t,{R:()=>i,x:()=>s});var r=n(6540);const o={},a=r.createContext(o);function i(e){const t=r.useContext(a);return r.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function s(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:i(e.components),r.createElement(a.Provider,{value:t},e.children)}}}]);